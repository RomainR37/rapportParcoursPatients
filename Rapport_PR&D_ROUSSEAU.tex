\documentclass{polytech/polytech}

\typereport{prddi5}

\reportyear{2018-2019}
\title{Outil de gestion de parcours patient dans un hôpital de jour}
\student[di5]{Romain}{ROUSSEAU}{romain.rousseau@etu.univ-tours.fr}
\academicsupervisor{Yannick}{KERGOSIEN}{yannick.kergosien@univ-tours.fr}

\resume{}

\motcle{}

\abstract{}

\keyword{}

\posterblock{}{}{images/LOGO_APHP}{}

\posterblock{}{}{images/LOGO_APHP}{}

\posterblock{}{}{images/LOGO_APHP}{}


\addbibresource{PRD2.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\chapter*{Introduction}

Ce rapport traite du projet Recherche et Développement réalisé au sein de l'école Polytech. Il se déroule lors la cinquième année d'étude et représente une forme de synthèse des connaissances acquises lors des années d’études précédentes. Il permet de développer et d’approfondir son savoir sur un ou plusieurs champs de compétences spécifiques, afin de devenir un spécialiste du domaine choisi dans le cadre du projet. Ce travail est mené seul, sous la supervision d'un tuteur académique et, pour certains projets, avec l’aide d’un intervenant extérieur qui fait partie des initiateurs du sujet. Il permet ainsi de développer son autonomie en menant à bien un travail des prémices jusque, dans le meilleur des cas, à la production.

J'ai décidé de me consacrer à un projet lié à un enjeu important de notre société: la gestion des patients dans un hôpital. Aujourd'hui, les hôpitaux sont l'objet de nombreux débats dans l'actualité, et l'un des points de discorde majeurs concerne la gestion des patients au sein des hôpitaux. Plusieurs problèmes peuvent être cités: un temps d'attente bien trop long pour les patients (que ce soit une fois à l'hôpital ou pour avoir un rendez-vous avec un spécialiste), des problèmes de ressource (concernant le personnel ou bien les salles à disposition) ou encore des problèmes d'ordre financier en général. Certaines de ses problématiques peuvent être étudiées selon le point de vue de l'optimisation, et la recherche opérationnelle peut permettre d'améliorer certains aspects de la gestion actuelle. Pour ma part, me pencher sur les problèmes de recherche opérationnelle en général m'intéressait, et avoir l'opportunité de réaliser un projet dans ce domaine, d'autant plus dans un secteur qui en a besoin, était une bonne occasion pour améliorer mes compétences.

Le sujet de ce travail rentre dans le cadre d’un projet visant à développer un outil de gestion temps réel de parcours de patients pour l’AP-HP (Assistance publique - Hôpitaux de Paris). L'objectif de cet outil est de gérer un ensemble de patients nécessitant plusieurs activités de soins planifiées sur une journée dans un hôpital de jour. Chaque patient doit suivre un « parcours de soins » défini par un ensemble d’activités de soins. Certaines doivent être réalisées avant d'autres (contraintes de précédences) alors que pour d'autres, l’ordre n’a pas d’importance. Il peut exister des délais d'attente à respecter entre les activités. Chaque activité de soin est caractérisée par une durée et un ensemble de ressources nécessaires pour la réaliser. Ces ressources peuvent représenter le personnel, la salle où s'effectue l'activité ou encore le matériel utilisé. Elles sont caractérisées par une quantité et un horaire où elles sont disponibles. L'idée de l'outil est de pouvoir proposer un calendrier adaptatif dans lequel les horaires des activités de soins des patients peuvent être ajustés en fonction des aléas potentiels (retard, patient absent, etc.) afin de diminuer du mieux possible le temps d'attente des patients.

Ce projet est la suite de plusieurs travaux effectués à l'école ces dernières années et qui ont abouti à une première version simple d'un outil sous forme de plateforme web. L'objectif est d'améliorer l'outil actuel en corrigeant certains problèmes et en ajoutant des fonctionnalités afin de se rapprocher d'une version finale exploitable à l'avenir. Parmi les fonctionnalités qui devront être ajoutées, on peut notamment penser à la planification automatique des activités de soin sur le calendrier ou encore l'ajout de notions de temps réel sur les éléments du calendrier.

La première partie de ce rapport sera consacrée à l'analyse préliminaire de la plateforme et à la détermination des tâches à réaliser. Elle comprend des éléments sur le contexte de la réalisation, la description de la plateforme telle qu'elle se trouvait au début du projet, un état de l'art sur les outils existants et sur la gestion de la planification des activités, et la présentation des tâches qui seront effectuées durant les semaines de projet. La seconde partie sera dédiée aux détails des développements de la plateforme. Des documents complémentaires sont disponibles en annexe de ce rapport comme les diagrammes de Gantt, les diagrammes UML, des éléments de gestion de projet, etc. Un guide développeur destiné aux personnes qui désireront reprendre le projet à l'avenir est également présent en complément.


\part{Analyse préliminaire et détermination des objectifs}


Cette partie correspond à la première phase du Projet Recherche et Développement, la partie Recherche. Dans le cadre de ce projet, cette partie sera une analyse générale de la plateforme existante afin de déterminer quels objectifs nous devrons atteindre à l'issue de ce projet. Le premier chapitre sera consacré au contexte de la réalisation, la raison de l'initiation du projet ainsi que les acteurs concernés. Le chapitre suivant décrira la plateforme telle qu'elle se trouvait à la reprise du sujet, en détaillant la structure et les fonctionnalités qu'elle contient. Enfin le dernier chapitre évoquera des éléments de recherche opérationnelle dans le domaine de la gestion des patients dans un hôpital. 


\chapter{Contexte de la réalisation et objectifs}
\label{chap:contexte}

Ce chapitre présente le contexte du sujet et les objectifs à atteindre à l'issue du projet.

\section{Contexte, enjeux et acteurs}

La santé dans notre société est un sujet prédominant dans l'actualité. De nombreux débats existent concernant la modernisation des structures hospitalières et surtout, la réduction des dépenses dans le secteur. Cependant, ces problématiques sont très complexes à gérer car il est important de maintenir une certaine qualité d'accueil nécessaire au bon traitement des patients, néanmoins une baisse des dépenses pourrait se répercuter dans la qualité des prestations. L'un des aspects sur lesquels ce projet sera consacré est la gestion de prise de rendez-vous médicale. Les consultations sont soumises à de nombreux aléas, que ce soit côté patient comme côté médecin. Il n'est pas rare pour un patient de devoir attendre plusieurs mois avant d'avoir un rendez-vous chez un spécialiste, tout comme il est fréquent pour un médecin de se retrouver avec un patient absent lors d'un rendez-vous. Ceci entraîne de la frustration et du gaspillage de ressources en général. Des solutions dans le domaine de la recherche opérationnelle peuvent être mises en place, afin d'améliorer la gestion des ressources médicales et de réduire les temps d'attente pour les patients, que ce soit avant ou pendant la prise en charge. 

Les services hospitaliers sont souvent surchargés par le nombre de patients dans l'établissement. Il est de plus en plus fréquent de voir les hôpitaux proposer des services en ambulatoire, c'est-à-dire prendre en charge un patient sur une seule journée, évitant ainsi les frais pouvant s'appliquer lorsqu'un patient dort sur place. Les dépenses liées aux hospitalisations sont parmi les plus importantes dans un établissement et de nos jours, les hôpitaux proposent même des alternatives pour que les patients ne restent pas sur place la nuit, comme par exemple des chambres d'hôtel afin de ne pas occuper une chambre pendant l'hospitalisation \cite{noauthor_chu_nodate}. Un établissement, ou une partie d'établissement, proposant ce type de service est appelé "hôpital de jour".

L'idée d'implémentation d'un outil numérique dans une structure implique une réflexion sur les concepts liés l'hospitalisation d'un patient. Il est possible de définir, selon les pathologies à traiter, un parcours-patient à suivre. Un parcours-patient (ou parcours-clinique) est un plan de soins pluridisciplinaires exposant les étapes que doivent un patient pour un problème spécifique. On peut les décomposer en plusieurs activités prédéfinies, certaines devant être réalisées avant d'autres (ce qu'on appelle une contrainte de précédence), nécessitant des ressources physiques ou matérielles (contrainte de ressources) et devant être effectuées dans un délai ou un créneau horaire précis (contrainte temporelles). La mise en place d'un système de centralisation des parcours-patient reste difficile, notamment car elle repose en priorité sur une bonne communication entre les services d'un établissement. Néanmoins, cela permettrait d'avoir potentiellement une meilleure utilisation des ressources de l'hôpital et par conséquent, un effet favorable sur les durées d'hospitalisation et les dépenses hospitalières entre autres.

L'Assistance Publique - Hôpitaux de Paris (AP-HP), dans son plan stratégique 2015 - 2019, a lancé une réflexion sur la mise en place d'une clinique ambulatoire. Avec la mutualisation de certains services au sein de différents hôpitaux de la région, le site de l'hôpital \textit{Béclère}, situé dans la ville de Clamart dans le département des Hauts-de-Seine, obtiendra un gain de place suffisant pour proposer une telle solution. Il regroupera tous les hôpitaux de jour existants du site, avec un management centralisé et transversal à l'aide de parcours-patients. Les équipes médicales et administratives ont pris le soin de définir d'ors et déjà une vingtaine de parcours patients en adéquation avec les ressources déjà en place, et présenté une répartition type des prises en charge hebdomadaire. Celle-ci devrait en théorie permettre d'accueillir 179 patients chaque semaine, et à terme environ 1000 par mois. Ainsi, la conception d'un système d'aide à la décision pour la prise de rendez-vous serait utile pour une nouvelle structure comme celle-ci.

Le sujet a été proposé en 2015 par Lucie ROUSSEL, ingénieur en ordonnancement à l'AP-HP et a été suivi lors de plusieurs projets à Polytech: tout d'abord, lors d'un projet collectif (réalisé par les étudiants Benjamin COLMART, Jean COQUELET, Anaëlle HAMON, Jiang MING, Yan LI et Minghui ZHANG) qui a posé les bases de la modélisation et des premières fonctionnalités, un projet R\&D effectué par Jean COQUELET en 2016 également basé davantage sur l'aspect gestion et optimisation des parcours, un projet R\&D par Guillaume POCHET en 2017 qui a ajouté des éléments sur la gestion de calendrier et enfin un autre projet R\&D réalisé par Jing YANG qui ajoute des améliorations générales. Le projet tel qu'il est développé à Polytech servira dans un premier temps en tant que \textit{proof of concept}, et si celui-ci satisfait l'administration, il pourra entrer en production à plus grande échelle dans le futur.

La plateforme, une fois installée sur mon poste à la reprise du projet, fonctionne. Il est possible d'ajouter des patients et de leur associer un parcours-patient avec des heures de rendez-vous et des activités à suivre lors d'une journée. Cependant, de nombreux éléments sont à améliorer, des bugs à corriger dans un premier temps mais aussi des améliorations d'un point de vue graphique. Des fonctionnalités importantes restent à implémenter: d'un côté, l'ajout d'une notion de temps réel sur les activités et les rendez-vous, et de l'autre, la possibilité de faire une planification automatique tenant compte des patients et des ressources disponibles. Compte-tenu du temps alloué pour le projet, il sera difficile d'ajouter ces deux fonctionnalités importantes. Nous verrons par la suite vers quels éléments nous allons nous pencher en priorité. 


\section{Objectifs}

Suite à l'affectation du sujet, les premières rencontres avec M. KERGOSIEN ont permis de fixer des objectifs principaux pour mener à bien le projet. Trois axes de développement ont été définis pour la finalisation de la plateforme : la correction de certains problèmes sur les fonctionnalités existantes, l'ajout de fonctions de planification automatique et l'implémentation de fonctionnalités permettant de planifier en temps réel. 

Les trois objectifs présentés par la suite sont conséquents en terme de temps. Il sera sans doute très compliqué de réaliser les trois objectifs dans la limite de temps alloué au projet. Nous nous focaliserons ainsi sur deux des trois objectifs à suivre. 


\subsection{Corrections des bugs et améliorations sur les fonctionnalités existantes}

Le premier objectif consiste à corriger certaines erreurs que l'on peut trouver sur la plateforme. À la première analyse du projet, plusieurs problèmes sont apparus, que ce soit des erreurs d'affichage ou des soucis d'ergonomie par exemple. Ainsi, le but est d'améliorer les éléments déjà existants de la plateforme afin de la rendre plus stable et de meilleur qualité. Parmi les corrections et améliorations à apporter, on retrouve la révision de la suppression de données, de l'onglet "Plan de parcours", du formulaire de création de patient, de certains éléments de la page d'accueil. 

Plusieurs fonctionnalités qui n'ont pas encore été implémentées sont aussi à rajouter pour enrichir les possibilités offertes à l'utilisateur, comme l'affichage du planning pour un patient donné, l'ajout de fonctions de tri pour l'affichage des ressources, ou encore, la création de jeux de données permettant de tester plus facilement la planification. 


\subsection{Implémentation de la planification automatique}
\label{subsec:planAuto}


L'une des parties principales du projet consiste à l'élaboration de la planification automatique les rendez-vous médicaux. À l'heure actuelle, la planification des rendez-vous se fait de façon manuelle. Une fois les patients définis pour une journée, un calendrier et la liste des activités à réaliser sont à disposition. Par un système de "glisser-déposer", l'administrateur peut agencer les activités selon les ressources disponibles (en terme de personnels ou de matériels). Cependant, l'agencement manuel des activités peut prendre un temps considérable, car pour chaque activité, il faut prendre en compte les activités qui peuvent la précéder ou la suivre, voir si le personnel est disponible, si les salles le sont également, etc. Lorsque le nombre de patients commence à se multiplier, la planification manuelle des activités devient un véritable casse-tête.

La planification automatique des activités permettrait d'avoir un premier agencement plus facile, et par conséquent, de gagner un temps considérable lors de l'élaboration des plannings. La notion d'automatisme peut être néanmoins très large, il sera important de la définir. Cela peut aller de la planification la plus simple, sans prendre en compte certaines contraintes et que l'utilisateur pourra corriger à sa guise, à une planification complète avec des options sélectionnées (agencement des activités au plus tôt de la journée, minimisation du temps d'attente pour les patients, pour les médecins, etc.). Une donnée importante est à prendre en compte: plus le type d'automatisation que l'on souhaite est précise ou détaillée, plus la modélisation nécessaire pour trouver une solution sera complexe. Ainsi, le but sera dans un premier temps de réaliser une première automatisation la plus simple possible puis, si les conditions sont réunies, faire évoluer le modèle et le complexifier davantage.


\subsection{Implémentation de la planification temps réel}

Le dernier objectif fixé lors des premières réunions est l'ajout d'une notion de temps réel à l'application. La plateforme pour le moment est conçue pour que l'utilisateur crée un planning pour une journée à un moment particulier (le matin avant les consultations ou le soir pour les rendez-vous du lendemain). Une fois le planning acté, il est difficile de le modifier en direct si un aléa se produit (par exemple, si un rendez-vous est annulé) à cause notamment des contraintes de précedence et de durée qui peuvent exister entre les activités. 

L'idée serait donc d'ajouter des fonctionnalités permettant d'ajuster le planning en temps réel. Tout comme la planification automatique, cela peut impliquer des concepts différents qu'il est nécessaire de définir. Cela peut aller d'un simple indicateur sur le calendrier pour voir où nous en sommes dans la journée, jusqu'à un système de pointage pour chaque activité. Il est possible d'imaginer un outil pour lequel les médecins pointent à chaque début de rendez-vous puis signalent dès que le rendez-vous est terminé sur la plateforme. Ainsi, il serait possible d'ajuster les activités en temps réel en cas de retard voire même en cas d'avance sur la planning. 

Se pencher sur la planification en temps réel nécessiterait une refonte de la modélisation du système, notamment en ce qui concerne les activités. Compte tenu du temps alloué au projet et aux autres objectifs à réaliser, nous avons décidé de nous focaliser en priorité sur les deux premiers objectifs. Si les évolutions avancent plus rapidement que prévu, nous pourrons songer à implémenter certains éléments. Dans un premier temps, nous nous tiendrons au chiffrage initial du projet (chiffrage disponible en \autoref{ann:chiffrage}).


\section{Bases méthodologiques}

À l'issue des premières réunions de lancement du projet, nous avons avec mon encadrant établi un chiffrage du projet avec les objectifs à réaliser et une estimation du temps de travail pour chaque activité. Ce chiffrage est visible en \autoref{ann:chiffrage}. Une fois le chiffrage effectué, j'ai établi un diagramme de Gantt pour planifier les étapes au long du projet. Le découpage des étapes peut s'apparenter à une méthode Agile, avec un sprint représentant une étape à réaliser. Les détails concernant le découpage et le cheminement du projet sont disponibles en \autoref{ann:gantt}.

En ce qui concerne l'organisation des tâches, j'utilise l'outil de gestion de projet \textit{Trello}. Les détails concernant l'outil et l'utilisation que j'en ai fait sont disponibles en \autoref{ann:gestion}.

Concernant la méthodologie de développement, la plateforme a été réalisée en suivant un pattern MVC. Je vais donc reprendre le code en respectant l'organisation déjà établie.


\chapter{Description générale}


Ce chapitre est consacré à la description générale de la plateforme. Nous évoquerons l'environnement autour du projet, les caractéristiques des futurs utilisateurs, les fonctionnalités du système ainsi que sa structure générale.

\section{Environnement du projet}


Comme évoqué dans le \autoref{chap:contexte}, ce projet est la reprise de plusieurs projets successifs effectués par les étudiants de Polytech. Il a été initié lors de l'année scolaire 2015-2016 avec un projet R\&D et un projet collectif en simultané. Par la suite, plusieurs projets R\&D se sont imbriqués chaque année de façon successive. La première modélisation et les premières briques de code datent donc de plusieurs années maintenant. 

L'application existante fonctionne sur une machine locale et est déployée via la plateforme de développement Web WAMP. Cette plateforme permet de faire fonctionner localement des scripts PHP sur machine Windows. WAMP fait le lien entre 4 composantes comme indiqué dans son acronyme : 

\begin{description}
	\item[Windows] comme le nom du système d'exploitation qui assurera la distribution des ressources entre les composants;
	\item[Apache] comme le serveur Web qui va déployer l'application et répondre aux requêtes Web du navigateur;
	\item[MySQL] comme le nom de la base de données utilisée pour l'application;
	\item[PHP] comme le langage de script utilisé. 
\end{description}

Les développements lors de ce projet ont été effectués sur ma machine personnelle, sous Windows 10, et en utilisant le navigateur \textit{Mozilla Firefox}. Le diagramme de déploiement de la \autoref{fig:deploiement} représente les liens entre le serveur, la base de données et l'application. 

\begin{figure}
	\includegraphics[scale=0.8]{images/deploiement}
	\caption{Diagramme de déploiement}
	\label{fig:deploiement}
\end{figure}

L'application si elle est mise en production sera disponible dans un premier temps sur une machine à la disposition de la personne chargée de la coordination du planning au sein du service. Les évolutions sur la plateforme pourront amener à déployer l'application sur plusieurs machines en parallèle au sein de l'hôpital. Par exemple, si l'on souhaite implémenter un système de pointage en temps réel des activités, il serait intéressant d'avoir plusieurs postes à disposition pour faciliter la tâche. Ici, nous nous focaliserons sur un déploiement sur une unique machine. 


\section{Caractéristiques des utilisateurs}
\label{sec:caracUtili}

La plateforme incorpore un système de gestion de compte afin de garantir la sécurité des données. Nous pouvons définir 2 types d'utilisateurs pour l'application.

\begin{itemize}
	\item Le personnel de soins : ils auront accès à la majorité des fonctionnalités de la plateforme (l'ajout et la recherche de patients, l'accès à leur planning personnel et au planning des patients). Ils ne pourront pas effectuer de modification sur les rendez-vous ou sur le planning en général.
	\item Administrateurs et infirmières de coordination : ils disposeront de tous les droits sur l'application. Ils pourront réaliser les mêmes opérations que le personnel de soins et auront la possibilité de gérer les ressources, gérer les activités, créer et modifier les plannings, ajouter et modifier un parcours-patient, etc.
\end{itemize}

Les utilisateurs de l'application devront s'authentifier pour pouvoir accéder aux différentes fonctionnalités et selon leur grade, ils auront accès aux éléments avec lesquels ils pourront interagir. 


\section{Contraintes de développement}

\'{E}tant donné que ce projet fait suite à plusieurs projets consécutifs et que la base de la plateforme a déjà été développée, il faudra utiliser les mêmes langages de programmes ainsi que les mêmes frameworks que lors des projets passés. Ainsi, les contraintes concernent les langages \textit{HTML}, \textit{CSS}, \textit{Javascript}, \textit{PHP}. La structure de l'application sera la même, à savoir une architecture MVC (Modèle - Vue - Contrôleur) mise en place à l'aide du framework PHP \textit{CodeIgniter}. En ce qui concerne la mise en page (\textit{CSS}), nous utiliserons \textit{Bootstrap}.

Guillaume POCHET, qui a effectué son PR\&D sur le sujet lors de l'année scolaire 2016-2017, avait réalisé un état de l'art sur les bibliothèques utilisables pour mettre en place un planning interactif \cite{pochet_outil_nodate}. À la suite de cela, il avait décidé d'utiliser la bibliothèque \textit{FullCalendar} pour constituer les plannings sur la plateforme. Nous poursuivrons avec l'utilisation de cette même bibliothèque.

De la même façon que pour les langages, il faudra reprendre la structure de la plateforme et le modèle de la base de données. Les détails concernant les structures seront dans la section suivante \autoref{sec:structure}.


\section{Description des interfaces externes du système}

\subsection{Interface matériel/logiciel}

L'application est une interface web qui fonctionne au travers d'un navigateur. Il faut donc disposer d'un ordinateur avec un navigateur web qui intègre \textit{Javascript} pour pouvoir utiliser l'application. La présence de \textit{Javascript} est nécessaire pour la visualisation du calendrier. Pour le moment, la plateforme est reliée une base de données qui doit être installée sur la machine et qui récupèrera les différentes informations nécessaires au fonctionnement de l'application. 


\subsection{Interface homme/machine}

Les utilisateurs accéderont à l'application par le biais d'un compte. L'authentification se fait à l'aide d'un nom d'utilisateur et d'un mot de passe. La création de compte est gérée par l'administrateur qui définira un type au nouveau compte créé.

On peut distinguer deux types d'utilisateurs qui ont été définis dans la \autoref{sec:caracUtili}. Par conséquent, le type d'utilisateur définira les différents onglets à afficher ou non. 

Les pages web et les onglets déjà présentes seront réutilisés lors de ce projet. Il n'y aura pas de nouvelles pages qui seront créées durant ce travail, néanmoins des modifications seront apportées aux pages actuelles, le tout en conservant l'aspect général et la charte graphique de l'application d'origine. 


\subsection{Interface logiciel/logiciel}

Comme évoqué auparavant, l'application web est liée à une base de données via \textit{MySQL}. La connexion à la base se fait au travers des classes de configurations du framework \textit{CodeIgniter}. Les contrôleurs de notre modèle MVC vont faire la liaison entre la base et l'affichage des informations. 


\section{Fonctionnalités du système}

Cette section regroupe les fonctionnalités qui vont être implémentées lors de ce projet. Les fonctionnalités déjà existantes se trouvent en \autoref{ann:foncExist}. La suite présentera les fonctionnalités qui seront ajoutées lors de ce projet. 


\subsection{Ajout de fonctions de tri lors de l'affichage des ressources}

Lors de la reprise du projet, sur les premiers tests, nous avons pu observer plusieurs corrections à apporter à la plateforme. L'une d'entre elles qui m'a semblé intéressante est l'ajout de fonctions de tri lors de l'affichage des ressources. Lorsque l'on souhaite consulter le personnel, les salles ou les activités par exemple, l'affichage se fait sous forme de liste comme on peut le voir sur la \autoref{fig:affPersonnel}.

\begin{figure}
	\includegraphics[scale=0.45]{images/affichage_personnel}
	\caption{Affichage du personnel sur la plateforme}
	\label{fig:affPersonnel}
\end{figure}

Cependant, dès que le nombre d'éléments dans la liste est conséquent, il devient vite difficile de trouver l'élément que l'on souhaite, d'autant plus que ces onglets n'ont pas de fonctions de recherche d'éléments.

Réaliser des fonctions de recherche peut prendre beaucoup de temps et n'est pas une priorité majeure dans notre projet. Ainsi, le compromis pour retrouver plus facilement les éléments et ne pas perdre du temps sur des fonctionnalités non prioritaires est d'ajouter des fonctions de tris sur les onglets. L'idée serait d'avoir la possibilité de trier les éléments par nom et par spécificité selon l'onglet (tri par poste pour le personnel, tri par spécialité pour les salles, etc.).


\subsection{Ajustement du planning selon les ressources sélectionnées}

Selon le même principe que l'ajout de fonctions de tri sur les onglets de gestion, un des ajustements possibles qui améliorerait l'expérience utilisateur sur la plateforme est la possibilité d'ajuster le planning selon les ressources que l'on souhaite faire apparaître.

La mise en place du planning fait partie des fonctionnalités les plus importantes mais aussi des plus complexes de la plateforme. Sur l'onglet Planification, à la reprise du projet, toutes les ressources existantes sont affichées dans le calendrier, et ainsi on peut glisser-déposer les activités non attribuées sur la ressource que l'on souhaite. Or, le nombre de ressources présentes dans l'hôpital peut vite se multiplier, et la gestion du planning devient alors très vite difficile dans ce cas.

Rendre l'affichage plus lisible et plus facile d'utilisation pour l'utilisateur n'est néanmoins pas une mince affaire car chaque information présente sur la page est importante pour faire le planning. Là où les améliorations peuvent se faire, c'est au niveau de la disposition des informations à l'écran. L'une des idées pour améliorer l'affichage est d'afficher uniquement les ressources que l'on souhaite faire apparaître à l'écran, c'est-à-dire afficher uniquement un type de personnel ou un type de salle précis. Cela permettrait de limiter les affichages à l'écran et de voir plus facilement les problèmes d'ordonnancement liés à un certain type de ressources. Par exemple, s'il y a un problème de gestion de salle (si une salle est réservée pour deux rendez-vous au même moment), en affichant uniquement les salles de l'hôpital, on peut voir directement où est le problème sans avoir à chercher parmi le flot d'informations que peut contenir la page principale. 


\subsection{Planification automatique}

Comme évoquée dans les parties précédentes de ce rapport (notamment dans la \autoref{subsec:planAuto}), l'élaboration du planning manuellement peut s'avérer très chronophage d'une part, car il faut glisser-déposer chaque activité du parcours pour chaque patient ce qui peut vite représenter plusieurs dizaines d'activités à agencer tout en prenant en compte chacune de leurs contraintes, et redondant d'autre part, car trouver un planning qui respecte les contraintes peut être long mais de plus ré-itérer cela tous les jours peut être éprouvant pour la personne en charge des plannings. La planification automatique va par conséquent être une fonctionnalité majeure de la plateforme. 

La planification automatique peut se matérialiser de plusieurs manières sur l'application. Un bouton a déjà été ajouté sur la page de planification que l'on peut voir sur la \autoref{fig:boutonPlanAuto} mais celui-ci est inactif. L'idée derrière cette implémentation réalisée lors des projets précédents est d'agencer automatiquement les activités non-attribuées sur le calendrier d'un clic sur le bouton à l'écran. 

\begin{figure}
	\includegraphics[scale=0.4]{images/bouton_plan_auto}
	\caption{Aperçu de la page de Planification}
	\label{fig:boutonPlanAuto}
\end{figure}

Toute la complexité de la fonctionnalité réside dans la notion que l'on souhaite donner à l'automatisme. Est-ce que l'on préfère trouver un planning qui minimise les temps d'attente des patients ? Ou alors, est-il préférable de minimiser les temps d'attente entre chaque rendez-vous pour les médecins ? Faut-il surcharger les salles quittent à \textit{over-booker} comme on peut le trouver dans les aéroports ? De nombreuses autres questions peuvent se poser à partir de ce problème.

Pour éviter les problèmes majeurs de complexité, nous allons commencer au plus simple: l'agencement patient par patient. L'idée derrière cela est d'avoir la liste des patients pris en charge le jour que l'on souhaite (comme on peut le voir pour les activités sur la \autoref{fig:boutonPlanAuto}), de sélectionner un patient et de cliquer sur un bouton qui placera chacune de ses activités du jour sur le calendrier. Le placement se fera au plus simple dans un premier temps, c'est-à-dire ajuster sur l'heure d'arrivée du patient et placer sur la première ressource disponible pour les activités. Même s'il peut y avoir des problèmes d'ordonnancement liés à cette méthode, la personne en charge pourra tout à fait ajuster l'agencement de la manière qui lui convient.

Mis en place de la sorte, même si la méthode ne donne pas un résultat parfait du premier coup, la fonctionnalité permettrait de gagner beaucoup de temps à l'utilisateur et de se débarrasser du coté redondant de l'agencement manuel. Selon l'avancement du projet, cette fonctionnalité pourra être étoffée et proposer de nouvelles options à l'utilisateur.


\section{Structure générale du système}
\label{sec:structure}

La structure générale du système est basée sur l'architecture MVC (Modèle - Vue - Contrôleur) par le biais du framework PHP \textit{CodeIgniter}. On peut voir un aperçu de l'arborescence du projet sur la \autoref{fig:arboMVC}. 

\begin{figure}
	\includegraphics[scale=1]{images/arboMVC}
	\caption{Arborescence du projet}
	\label{fig:arboMVC}
\end{figure}

Sur l'arborescence, les 3 parties du MVC sont présentes ainsi qu'un dossier \textit{config} qui regroupe les classes de configuration du framework et le dossier \textit{logs} avec les classes de logger de l'application. La partie Modèle représente les données de la plateforme (patient, ressources humaines, ressources matérielles, parcours, activités, etc.). La partie Contrôleur est utilisée pour faire le lien entre les données et les différentes vues. Elle va également permettre de gérer la cohérence et l'intégrité des données. La partie Vue regroupent les pages web de l'application. 

Concernant la base de données, nous reprendrons le modèle tel qu'il a été pensé lors des projets précédents. Les explications sur l'utilité des tables et le diagramme de Gantt se trouvent en annexe (\autoref{ann:expModele} pour les explications sur les tables et \autoref{ann:modeleBDD} pour le diagramme). Des ajustements sur certains champs de la base seront apportées, notamment lors de la modification du formulaire de création de patient. 


\chapter{État de l'art}


\section{Planification automatique}


\part{Développement}


\chapter{Analyse et conception}



\chapter{Mise en œuvre}


\chapter{Bilan et conclusion}


\appendix

\chapter{Fonctionnalités existantes}
\label{ann:foncExist}

L'application web a été produite par les étudiants au cours de l'année 2015-2016 de leur projet collectif et deux étudiants de son PRD. Ils ont développé une plate-forme permettant les fonctionnalités suivantes : gérer les personnels, gérer les ressources matérielles, gérer les activités, gérer les parcours et gérer le plan de parcours. Hors cela, la plate-forme peut aussi créer et rechercher des patients, puis leur affecter des parcours et planifier les activités.


\section{Gérer les personnels}

Chaque personnel a une fonctionnalité dans l'hôpital, l'administrateur peut les modifier, supprimer et les mettre en indisponibilité.

\begin{itemize}
	\item Modifier un personnel
	\item Supprimer un personnel
	\item Mettre un personnel en indisponibilité
\end{itemize}

\section{Gérer les ressources matérielles}

Chaque ressource matérielle a un nom et une spécialité.

\begin{itemize}
	\item Modifier une ressource matérielle Cette fonctionnalité est implémentée mais elle ne fonctionne pas bien car elle pose le problème de la base de données, il faut une amélioration.
	\item Supprimer une ressource matérielle Cette fonctionnalité a été implémentée mais elle ne fonctionne pas donc on a besoin de la faire fonctionner.
	\item Mettre un personnel en indisponibilité
\end{itemize}

\section{Gérer les activités}

Chaque activité doit avoir un nom et une durée, elle sera faite dans une certaine salle et par un type de personnel.

\begin{itemize}
	\item Ajouter une nouvelle activité
	\item Modifier les activités existantes
	\item Supprimer les activités qui n’existent plus
\end{itemize}


\section{Gérer les parcours}

Un parcours se compose par plusieurs activités dont il y a un ordre entre tous les activités, donc il faut faire attention aux activités qui doivent être en précédentes des autres.

\begin{itemize}
	\item Ajouter un nouveau parcours
	\item Modifier un parcours
	\item Supprimer un parcours
	\item Visualiser un parcours
\end{itemize}

\section{Gérer les plans de parcours}

Dans un hôpital de jour, la capacité de recueillir les patients est limite, donc dans une journée il peut affecter un certain nombre de patients au même parcours.

\section{Visualiser du planning}

Une fonctionnalité « afficher planning du patient » est disponible et permet de visualiser l’heure de début et de fin de la prochaine activité du patient dans son parcours. Cette visualisation est visible par l’administrateur, le personnel de soins et également par le patient.

\section{Affecter un patient à un parcours}


Le patient peut être affecté à un parcours en précisant les disponibilités de ce dernier. Les disponibilités du patient seront demandées sous formes d’horaires (exemple : 8h-17h). Cette fonctionnalité est disponible à l'administrateur et aux personnels de soins. 

L'administrateur ou infirmière de coordination peuvent affecter un patient à un parcours pour une journée donnée et pouvoir visualiser également le nombre de patients déjà affecté sur cette dernière.

Lors d'un clic sur le bouton affecter, l'administrateur sera redirigé vers une page où il pourra choisir le patient à affecter pour la date choisie précédemment.

\section{Visualiser et modifier le planning de toutes les ressources}

L'administrateur peut visualiser et modifier en temps réel le planning de toutes les ressources et également d'une ressource en particulier. La modification peut s'effectuer de façon manuelle (en déplaçant les activités). L'administrateur doit pouvoir planifier automatiquement le planning de ses ressources pour une journée donnée. La planification automatique ne sera pas incluse dans le cadre de mon projet de recherche et développement. Ces fonctionnalités ne sont disponibles qu’à l’administrateur. Les différentes interfaces ont été étudié dans la partie veille technologique sur \textit{fullCalendar}.

\chapter{Modèle conceptuel de données}
\label{ann:modeleBDD}

\begin{figure}
	\includegraphics[scale=0.5]{images/tablesBD}
	\caption{Diagramme de classe}
	\label{fig:modeleBDD}
\end{figure}

\chapter{Explications des tables du modèle}
\label{ann:expModele}

%%PRD Jing

Voici l'explication sur les tables créées dans l'ancien projet [2]que je vais continuer à utiliser.

\begin{description}
	\item[Activité] : Table regroupant l'ensemble des informations concernant une activité. C'est cet élément qui constitue les parcours. Une activité peut obliger la réalisation de certaines autres activités avant d'être réalisable. Cette notion de dépendance dépend du parcours en cours. Cette notion de précédence est sera vue plus loin via la table composer. En plus de cela, une activité a besoin de ressources. Ce lien se fait par la table nécessiter.
	\item[Champ] : Table contenant l'ensemble des champs qu'il est possible d'ajouter dans un onglet d'un dossier Parcours. À chaque champ est lié un type de champ, que nous verrons plus loin, avec la table typechamp.
	\item[Composer] : Table permettant de faire le lien entre un parcours et une activité. Par l'intermédiaire de cette table nous pouvons dire en fonction d'un parcours et d'une activité s'il y a des besoins en termes de précédence. Chaque ligne, dans cette table, a pour signification : « Pour l'activité A dans le parcours P, il faut avoir réalisé l'activité B avant, et ce dans un délai compris entre delaiMin et delaiMax. ». Il est important de noter qu'il est possible de mettre à « null », l'id de l'activité précédente.
	\item[Compte] : Table regroupant l'ensemble des comptes qu'ils soient des comptes patient ou des comptes de type ressource médicale.
	\item[Constituerdossier] : Table permettant de faire le lien entre un dossier parcours et les informations qui le constituent. En effet, nous retrouvons pour chaque dossier parcours et pour chaque onglet dans ce dernier, la valeur des champs le composant.
	\item[Dossiergenerique] : Table définissant, pour un parcours, les onglets et les champs que tous les dossiers parcours doivent avoir impérativement.
	\item[Dossierparcours] : Table renseignant les informations génériques d'un dossier parcours. Soit le patient associé, le parcours, dates de création et de dernière modification.
	\item[Etreindisponible] : Table regroupant l'ensemble des indisponibilités pour une ressource. Cette indisponibilité est caractérisée par une date de début et de fin, acceptant toutes les deux le renseignement de l'heure.
	\item[Jour] : Table qui contient les jours de semaine, ainsi que leurs index sous MySQL. Cette table a un enjeu au niveau des prévisions du nombre de patient par jour pour un parcours.
	\item[Necessiter] : Table permettant de renseigner les types de ressources requises pour une activité, ainsi que la quantité nécessaire.
	\item[Onglet] : Table des onglets disponibles pour constituer un dossier parcours.
	\item[Parcours]	 : Table décrivant un parcours de façon générale.
	\item[Personnel] : Table contenant l'ensemble de personnel médical de l'établissement. Chaque personnel a un compte, et est considéré comme une ressource.
	\item[Planparcours] : Table regroupant l'ensemble des objectifs concernant le nombre de patients pour un parcours pour un jour donné.
	\item[Ressource] : Table faisant le lien entre la table typeressource et personnel ou matériel. Ce lien	sera expliqué plus en détail avec la table typeressource.
	\item[Typechamp] : Table regroupant les différents type de champs qu'il est possible d'ajouter dans un dossier parcours. Elle contient également le code HTML des composants, permettant ainsi une	mise en page en accord avec les autres éléments des pages.
	\item[Typecompte] : Table utilisée pour la gestion des droits.
	\item[Typeressource] : Table contenant les types de ressource d'un point de vue activité. En effet, une activité peut avoir besoin d'un type de ressource bien caractéristique (ex : IDE obésité). C'est pourquoi nous avons un double niveau de type de ressource. Un concernant les activités (typeressource) et un second plus d’un point de vue logique générale (personnel, matériel).
	\item[Ordonnancer] : Table de fait de notre système. C'est la table la plus importante. Chaque ligne veut dire : « Pour le patient P qui fait le parcours Pa à la date D, il a besoin de la ressource R pour faire l’activité A de start à end. Cette table contient la planification réalisée de manière manuelle ou automatique (pas implémenté pour le moment).
	\item[Evènement] : Table identique à la table Ordonnancer. Elle a le même but que la table ordonnancer mais cette table contient la planification en cours. Cette table permet de pouvoir sauvegarder ou restaurer la planification en fonction des modifications que l’utilisateur a effectuées.
\end{description}


\chapter{Chiffrage du projet}
\label{ann:chiffrage}

Revoir la suppression : 1 j
Revoir l'onglet "Plan de parcours" : 1,5 j
Revoir le formulaire de création de patient : 2 j
Revoir la page d'accueil : 1 j
Affichage du planning patient : 5 j
Ajouter des tris dans les onglets d'affichage : 1 j
Corriger le problème des URL : 2 j
Affichage des ressources sélectionnées et test planning : 10 j
Planification automatique : 20 j
Jeux de données : 3 j
Rapport : 15 j
Préparation soutenance : 3 j

\chapter{Gestion de projet}
\label{ann:gestion}

\chapter{Manuel développeur}


%TODO Supprimer le chapitre une fois terminé
\chapter{TEMPO}

\section*{Suppression}

La fonctionnalité "Supprimer" a été ajoutée lors du dernier PR\&D réalisé par Yang Jing. Elle est implémentée dans les onglets de Gestion de la plateforme pour avoir la possibilité de supprimer les ressources qui ne sont pas nécessaires ou qui sont devenues obsolètes.  

Cette fonctionnalité a des risques importants. En effet, la suppression d'un élément peut entraîner des répercussions sur l'intégralité de la plateforme (exemple ...). 

À l'heure actuelle, les boutons "Supprimer" ne disposent d'aucune sécurité, ce qui peut se révéler très dangereux. Un simple clic sur le bouton entraîne la disparition de la ressource sélectionnée. Compte tenu de la dangerosité de la manœuvre sur le bon fonctionnement de la plateforme, il est nécessaire de corriger ce problème. 

À minima, l'apparition d'un message de confirmation lors du clic sur le bouton permettrait d'éviter les mauvaises manipulations. 

Pour afficher un message de confirmation, il suffit d'ajouter \javacode{onclick="return confirm('Etes vous sur ?');"} sur le lien de l'action ...


\end{document}
